<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Keeta English Trainer â€” App-style</title>
  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --txt:#e5e7eb;
      --primary:#22c55e; --danger:#ef4444; --border:#1f2937; --gold:#facc15;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--txt);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Tajawal,Cairo,sans-serif; padding-bottom: 70px; /* Space for mobile nav */}
    header{position:sticky;top:0;background:linear-gradient(180deg,#0b1220,#0b1220dd);border-bottom:1px solid var(--border);backdrop-filter:blur(4px);z-index:5}
    .wrap{max-width:1100px;margin:0 auto;padding:16px}
    h1{margin:0;font-size:22px;display:flex;gap:10px;align-items:center}
    .badge{padding:2px 8px;border-radius:999px;background:#14331f;color:#9ff7ba;border:1px solid #205d33;font-size:12px}
    
    /* --- MODIFIED: Desktop Grid --- */
    .grid{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:900px){
      body { padding-bottom: 0; } /* No bottom padding on desktop */
      .grid{grid-template-columns: 320px 1fr}
    }

    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px}
    .muted{color:var(--muted);font-size:13px}
    button{border:1px solid var(--border);background:#111827;color:var(--txt);padding:10px 14px;border-radius:12px;cursor:pointer}
    button.primary{background:var(--primary);color:#07120b;border-color:#0f5132;font-weight:700}
    button.ghost{background:transparent}
    button:disabled{opacity:.6;cursor:not-allowed}
    input,select,textarea{width:100%;padding:12px;border:1px solid var(--border);border-radius:12px;background:#0b1220;color:var(--txt)}
    .xp{display:flex;gap:10px;align-items:center}
    .progress{height:8px;background:#0b1220;border:1px solid var(--border);border-radius:8px;overflow:hidden}
    .bar{height:100%;background:var(--primary);width:0%}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .pill{border:1px dashed var(--border);padding:6px 10px;border-radius:999px}
    .q{font-size:18px;line-height:1.6}
    .choices{display:grid;gap:10px;margin-top:10px}
    .choice{padding:12px;border:1px solid var(--border);border-radius:12px;background:#0b1220;cursor:pointer}
    .choice.correct{border-color:#14532d;background:#0b2415}
    .choice.wrong{border-color:#4b1a1a;background:#220d0d}
    .result{margin-top:10px;font-weight:700}
    .footer{opacity:.8;font-size:12px;text-align:center;margin:18px 0; display: none; /* Hidden, replaced by mobile nav */}
    .tag{font-size:12px;color:#9ca3af;border:1px solid var(--border);padding:2px 8px;border-radius:999px}
    .mode-tabs{display:flex;gap:8px;margin-bottom:8px}
    .hidden{display:none}
    .hint{font-size:12px;color:#93c5fd}
    .rtl{direction:rtl} .ltr{direction:ltr}
    
    .hover-word {
      cursor: help;
      text-decoration: underline dashed var(--muted);
      text-decoration-thickness: 1px;
    }
    
    .q-container {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    #btnSpeak {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      padding: 5px;
    }
    
    /* --- NEW: Mobile App-like Bottom Nav --- */
    .mobile-nav {
      display: none; /* Hidden on desktop by default */
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--card);
      border-top: 1px solid var(--border);
      justify-content: space-around;
      align-items: center;
      z-index: 10;
    }
    .mobile-nav button {
      background: none;
      border: none;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      font-size: 10px;
    }
    .mobile-nav button .icon {
      font-size: 22px;
    }
    .mobile-nav button.active {
      color: var(--primary);
    }

    /* --- Mobile View Adjustments --- */
    @media (max-width: 899px) {
      .mobile-nav {
        display: flex; /* Show nav on mobile */
      }
      .grid {
        display: block; /* Stack panels on mobile */
      }
      /* Hide the original desktop mode tabs on mobile */
      #settingsPanel .mode-tabs {
        display: none;
      }
      /* Hide settings panel by default on mobile */
      #settingsPanel {
        display: none;
      }
    }
    
  </style>
</head>
<body>

<header>
  <div class="wrap row">
    <h1>Keeta English Trainer <span class="badge">Daily XP</span></h1>
    <div class="row" style="margin-inline-start:auto">
      <div class="pill">â­ XP: <span id="xp">0</span></div>
      <div class="pill">ğŸ”¥ Streak: <span id="streak">0</span> days</div>
    </div>
  </div>
</header>

<div class="wrap grid">
  <aside class="card" id="settingsPanel">
    <div class="mode-tabs">
      <button class="primary" id="btnDaily">Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
      <button id="btnReview">Ù…Ø±Ø§Ø¬Ø¹Ø©</button>
    </div>
    <div class="row">
      <div class="progress" style="flex:1"><div id="bar" class="bar"></div></div>
      <span class="muted" id="goalText">0/20 XP</span>
    </div>
    <hr style="border-color:#1f2937">
    <div class="muted">Ø§Ù„Ù„ØºØ©:</div>
    <div class="row">
      <select id="uiLang">
        <option value="ar">ÙˆØ§Ø¬Ù‡Ø©: Ø¹Ø±Ø¨ÙŠ</option>
        <option value="en">ÙˆØ§Ø¬Ù‡Ø©: English</option>
      </select>
      <select id="exerciseLang">
        <option value="both">ØªÙ…Ø§Ø±ÙŠÙ†: Ø¹Ø±Ø¨ÙŠ â†” Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</option>
        <option value="en2ar">Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ â†’ Ø¹Ø±Ø¨ÙŠ</option>
        <option value="ar2en">Ø¹Ø±Ø¨ÙŠ â†’ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</option>
      </select>
    </div>
    <div class="muted" style="margin-top:8px">Ø§Ù„ÙØ¦Ø§Øª:</div>
    <div id="cats" class="row"></div>
    <hr style="border-color:#1f2937">
    <div class="muted">Ù†ØµØ§Ø¦Ø­:</div>
    <ul class="muted">
      <li>**Ø¬Ø¯ÙŠØ¯:** ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ† Ø¥Ù„Ù‰ 10,000 ØªÙ…Ø±ÙŠÙ†.</li>
      <li>Ø§Ù„ØµÙˆØª Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¥Ù„Ø§ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ğŸ”Š.</li>
      <li>Ù‚Ù Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ Ø¹Ù„Ù‰ Ø£ÙŠ ÙƒÙ„Ù…Ø© Ù„ØªØ±Ø¬Ù…Ø© *Ø§Ù„ÙƒÙ„Ù…Ø©* (Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„Ù‚Ø§Ù…ÙˆØ³).</li>
      <li>ØªÙ… Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© (80% Ù…Ù† Ø§Ù„Ø£Ø³Ø¦Ù„Ø©).</li>
    </ul>
  </aside>

  <main class="card" id="mainPanel">
    <div id="screenLesson">
      <div class="tag" id="catTag"></div>
      
      <div class="q-container">
        <button id="btnSpeak" title="Ù†Ø·Ù‚">ğŸ”Š</button>
        <div class="q" id="question">Ø§Ø¶ØºØ· Ø§Ø¨Ø¯Ø£ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¯Ø±Ø³</div>
      </div>
      
      <div class="hint" id="hint"></div>
      <div id="mc" class="choices hidden"></div>
      <div id="typing" class="hidden">
        <input id="answer" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù‡Ù†Ø§â€¦">
      </div>
      <div class="row" style="margin-top:12px">
        <button id="btnStart" class="primary">Ø§Ø¨Ø¯Ø£</button>
        <button id="btnCheck">ØªØ­Ù‚Ù‚</button>
        <button id="btnSkip" class="ghost">ØªØ®Ø·ÙŠ</button>
        <button id="btnHint" class="ghost">ØªÙ„Ù…ÙŠØ­</button>
      </div>
      <div id="result" class="result"></div>
    </div>

    <div id="screenReview" class="hidden">
      <h3>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</h3>
      <div id="revList"></div>
      <button id="btnPracticeWrong" class="primary">ØªØ¯Ø±ÙŠØ¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡</button>
    </div>
  </main>
</div>

<nav class="mobile-nav" id="mobileNav">
  <button class="active" data-tab="lesson">
    <span class="icon">ğŸ“š</span>
    <span>Ø§Ù„Ø¯Ø±Ø³</span>
  </button>
  <button data-tab="review">
    <span class="icon">ğŸ”„</span>
    <span>Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
  </button>
  <button data-tab="settings">
    <span class="icon">âš™ï¸</span>
    <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
  </button>
</nav>


<script>
// ===== NEW: Mini-Dictionary =====
const MINI_DICT_EN_AR = {
  "please": "Ù…Ù† ÙØ¶Ù„Ùƒ", "confirm": "ÙŠØ¤ÙƒØ¯", "complete": "ÙŠÙƒÙ…Ù„", "delivery": "ØªÙˆØµÙŠÙ„",
  "kindly": "Ù…Ù† ÙØ¶Ù„Ùƒ", "share": "ÙŠØ´Ø§Ø±Ùƒ", "location": "Ù…ÙˆÙ‚Ø¹", "start": "ÙŠØ¨Ø¯Ø£",
  "shift": "Ø´ÙŠÙØª", "on": "ÙÙŠ", "time": "ÙˆÙ‚Øª", "rider": "Ø³Ø§Ø¦Ù‚", "lost": "ÙÙ‚Ø¯",
  "validity": "ØµÙ„Ø§Ø­ÙŠØ©", "due": "Ø¨Ø³Ø¨Ø¨", "system": "Ù†Ø¸Ø§Ù…", "delay": "ØªØ£Ø®ÙŠØ±",
  "order": "Ø·Ù„Ø¨", "restaurant": "Ù…Ø·Ø¹Ù…", "issue": "Ù…Ø´ÙƒÙ„Ø©", "bike": "Ø¯Ø±Ø§Ø¬Ø©",
  "broke": "ØªØ¹Ø·Ù„Øª", "down": " ", "performance": "Ø£Ø¯Ø§Ø¡", "company": "Ø´Ø±ÙƒØ©",
  "dropped": "Ø§Ù†Ø®ÙØ¶", "low": "Ù…Ù†Ø®ÙØ¶", "rate": "Ù…Ø¹Ø¯Ù„", "need": "ÙŠØ­ØªØ§Ø¬",
  "increase": "ÙŠØ²ÙŠØ¯", "valid": "ØµØ§Ù„Ø­", "days": "Ø£ÙŠØ§Ù…", "reach": "ÙŠØµÙ„", "level": "Ù…Ø³ØªÙˆÙ‰",
  "motivate": "ÙŠØ­ÙØ²", "riders": "Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†", "improve": "ÙŠØ­Ø³Ù†", "find": "ÙŠØ¬Ø¯",
  "attached": "Ù…Ø±ÙÙ‚", "report": "ØªÙ‚Ø±ÙŠØ±", "updated": "Ù…Ø­Ø¯Ø«", "list": "Ù‚Ø§Ø¦Ù…Ø©",
  "thank": "Ø´ÙƒØ±Ø§", "you": "Ù„Ùƒ", "quick": "Ø³Ø±ÙŠØ¹", "response": "Ø±Ø¯", "my": "Ù„ÙŠ",
  "opinion": "Ø±Ø£ÙŠ", "should": "ÙŠØ¬Ø¨", "focus": "Ù†Ø±ÙƒØ²", "clarify": "ÙŠÙˆØ¶Ø­",
  "part": "Ø¬Ø²Ø¡", "let's": "Ø¯Ø¹Ù†Ø§", "review": "Ù†Ø±Ø§Ø¬Ø¹", "weekly": "Ø£Ø³Ø¨ÙˆØ¹ÙŠ",
  "great": "Ø¹Ø¸ÙŠÙ…", "effort": "Ù…Ø¬Ù‡ÙˆØ¯", "today": "Ø§Ù„ÙŠÙˆÙ…", "keep": "Ø§Ø³ØªÙ…Ø±", "up": " ",
  "improvement": "ØªØ­Ø³Ù†", "visible": "ÙˆØ§Ø¶Ø­", "believe": "Ù†Ø¹ØªÙ‚Ø¯", "target": "Ù‡Ø¯Ù",
  "follow": "ÙŠØªØ¨Ø¹", "rules": "Ù‚ÙˆØ§Ø¹Ø¯", "every": "ÙƒÙ„", "booked": "Ù…Ø­Ø¬ÙˆØ²",
  "must": "ÙŠØ¬Ø¨", "completed": "Ù…ÙƒØªÙ…Ù„", "repeated": "Ù…ØªÙƒØ±Ø±", "rejections": "Ø±ÙØ¶",
  "will": "Ø³ÙˆÙ", "affect": "ÙŠØ¤Ø«Ø±", "invoice": "ÙØ§ØªÙˆØ±Ø©", "your": "Ù„Ùƒ",
  "long": "Ø·ÙˆÙŠÙ„", "breaks": "Ø§Ø³ØªØ±Ø§Ø­Ø§Øª", "during": "Ø®Ù„Ø§Ù„", "peak": "Ø°Ø±ÙˆØ©",
  "customer": "Ø¹Ù…ÙŠÙ„", "answer": "ÙŠØ±Ø¯", "phone": "Ù‡Ø§ØªÙ", "changed": "ØºÙŠØ±",
  "app": "ØªØ·Ø¨ÙŠÙ‚", "was": "ÙƒØ§Ù†", "responding": "ÙŠØ³ØªØ¬ÙŠØ¨", "minutes": "Ø¯Ù‚Ø§Ø¦Ù‚",
  "received": "Ø§Ø³ØªÙ„Ù…Ù†Ø§", "message": "Ø±Ø³Ø§Ù„Ø©", "opened": "ÙØªØ­Ù†Ø§", "immediately": "ÙÙˆØ±Ø§",
  "marked": "Ø¹Ù„Ù…", "invalid": "ØºÙŠØ± ØµØ§Ù„Ø­", "mistake": "Ø®Ø·Ø£", "stuck": "Ø¹Ø§Ù„Ù‚",
  "traffic": "Ø²Ø­Ø§Ù…", "remove": "ÙŠØ²ÙŠÙ„", "penalty": "Ù…Ø®Ø§Ù„ÙØ©", "fault": "Ø®Ø·Ø£",
  "targeting": "Ù†Ø³ØªÙ‡Ø¯Ù", "month": "Ø´Ù‡Ø±", "file": "Ù…Ù„Ù", "link": "Ø±Ø§Ø¨Ø·",
  "below": "Ø£Ø¯Ù†Ø§Ù‡", "solutions": "Ø­Ù„ÙˆÙ„", "blame": "Ù„ÙˆÙ…", "give": "ÙŠØ³ØªØ³Ù„Ù…",
  "close": "Ù‚Ø±ÙŠØ¨", "consistency": "Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©", "key": "Ù…ÙØªØ§Ø­", "success": "Ù†Ø¬Ø§Ø­",
  "four": "Ø£Ø±Ø¨Ø¹Ø©", "status": "Ø­Ø§Ù„Ø©", "avoid": "ÙŠØªØ¬Ù†Ø¨", "unnecessary": "ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠ",
  "book": "ÙŠØ­Ø¬Ø²", "realistic": "ÙˆØ§Ù‚Ø¹ÙŠ", "total": "Ø¥Ø¬Ù…Ø§Ù„ÙŠ", "online": "Ù…ØªØµÙ„",
  "hours": "Ø³Ø§Ø¹Ø§Øª", "exceed": "ÙŠØªØ¬Ø§ÙˆØ²", "without": "Ø¨Ø¯ÙˆÙ†", "call": "ÙŠØªØµÙ„",
  "before": "Ù‚Ø¨Ù„", "marking": "ØªØ¹Ù„ÙŠÙ…", "delayed": "Ù…ØªØ£Ø®Ø±", "informed": "Ø£Ø¨Ù„ØºÙ†Ø§",
  "service": "Ø®Ø¯Ù…Ø©", "case": "Ø­Ø§Ù„Ø©", "escalate": "ÙŠØµØ¹Ø¯", "support": "Ø¯Ø¹Ù…",
  "team": "ÙØ±ÙŠÙ‚", "quiz": "Ø§Ø®ØªØ¨Ø§Ø±", "page": "ØµÙØ­Ø©", "loaded": "ØªØ­Ù…ÙŠÙ„", "late": "Ù…ØªØ£Ø®Ø±",
  "assessment": "ØªÙ‚ÙŠÙŠÙ…", "published": "ÙŠÙ†Ø´Ø±", "sunday": "Ø§Ù„Ø£Ø­Ø¯", "analyze": "ÙŠØ­Ù„Ù„",
  "root": "Ø¬Ø°Ø±ÙŠ", "cause": "Ø³Ø¨Ø¨", "failures": "Ø¥Ø®ÙØ§Ù‚Ø§Øª", "all": "ÙƒÙ„",
  "wear": "ÙŠØ±ØªØ¯ÙŠ", "official": "Ø±Ø³Ù…ÙŠ", "uniform": "Ø²ÙŠ", "provided": "Ù‚Ø¯Ù…",
  "wrong": "Ø®Ø§Ø·Ø¦", "pin": "Ù…ÙˆÙ‚Ø¹", "positive": "Ø¥ÙŠØ¬Ø§Ø¨ÙŠ", "attitude": "Ù…ÙˆÙ‚Ù",
  "appreciated": "Ù…Ù‚Ø¯Ø±", "what": "Ù…Ø§Ø°Ø§", "action": "Ø®Ø·Ø©", "plan": "Ø¹Ù…Ù„",
  "quarter": "Ø±Ø¨Ø¹", "average": "Ù…ØªÙˆØ³Ø·", "server": "Ø®Ø§Ø¯Ù…", "maintenance": "ØµÙŠØ§Ù†Ø©",
  "requests": "ÙŠØ·Ù„Ø¨", "contactless": "Ø¨Ø¯ÙˆÙ† ØªÙ„Ø§Ù…Ø³", "share": "ÙŠØ´Ø§Ø±Ùƒ", "information": "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª",
  "anyone": "Ø£ÙŠ Ø´Ø®Øµ", "create": "ÙŠÙ†Ø´Ø¦", "new": "Ø¬Ø¯ÙŠØ¯", "courier": "Ø³Ø§Ø¦Ù‚",
  "correct": "ØµØ­ÙŠØ­", "branch": "ÙØ±Ø¹", "group": "Ù…Ø¬Ù…ÙˆØ¹Ø©", "upload": "ÙŠØ±ÙØ¹",
  "mandatory": "Ø¥Ù„Ø²Ø§Ù…ÙŠ", "compliance": "Ø§Ù„ØªØ²Ø§Ù…", "documents": "Ù…Ø³ØªÙ†Ø¯Ø§Øª", "select": "ÙŠØ®ØªØ§Ø±",
  "vehicle": "Ù…Ø±ÙƒØ¨Ø©", "type": "Ù†ÙˆØ¹", "motorcycle": "Ø¯Ø±Ø§Ø¬Ø© Ù†Ø§Ø±ÙŠØ©", "car": "Ø³ÙŠØ§Ø±Ø©"
};
const MINI_DICT_AR_EN = {
  "Ù…Ù†": "from", "ÙØ¶Ù„Ùƒ": "please", "ÙŠØ¤ÙƒØ¯": "confirm", "ÙŠÙƒÙ…Ù„": "complete", "ØªÙˆØµÙŠÙ„": "delivery",
  "ÙŠØ´Ø§Ø±Ùƒ": "share", "Ù…ÙˆÙ‚Ø¹": "location", "ÙŠØ¨Ø¯Ø£": "start", "Ø´ÙŠÙØª": "shift", "ÙÙŠ": "in/on",
  "ÙˆÙ‚Øª": "time", "Ø³Ø§Ø¦Ù‚": "rider", "ÙÙ‚Ø¯": "lost", "ØµÙ„Ø§Ø­ÙŠØ©": "validity", "Ø¨Ø³Ø¨Ø¨": "due to",
  "Ù†Ø¸Ø§Ù…": "system", "ØªØ£Ø®ÙŠØ±": "delay", "Ø·Ù„Ø¨": "order", "Ù…Ø·Ø¹Ù…": "restaurant", "Ù…Ø´ÙƒÙ„Ø©": "issue",
  "Ø¯Ø±Ø§Ø¬Ø©": "bike", "ØªØ¹Ø·Ù„Øª": "broke down", "Ø£Ø¯Ø§Ø¡": "performance", "Ø´Ø±ÙƒØ©": "company",
  "Ø§Ù†Ø®ÙØ¶": "dropped", "Ù…Ù†Ø®ÙØ¶": "low", "Ù…Ø¹Ø¯Ù„": "rate", "ÙŠØ­ØªØ§Ø¬": "need", "ÙŠØ²ÙŠØ¯": "increase",
  "ØµØ§Ù„Ø­": "valid", "Ø£ÙŠØ§Ù…": "days", "ÙŠØµÙ„": "reach", "Ù…Ø³ØªÙˆÙ‰": "level", "ÙŠØ­ÙØ²": "motivate",
  "Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ†": "riders", "ÙŠØ­Ø³Ù†": "improve", "ÙŠØ¬Ø¯": "find", "Ù…Ø±ÙÙ‚": "attached",
  "ØªÙ‚Ø±ÙŠØ±": "report", "Ù…Ø­Ø¯Ø«": "updated", "Ù‚Ø§Ø¦Ù…Ø©": "list", "Ø´ÙƒØ±Ø§": "thank you", "Ø³Ø±ÙŠØ¹": "quick",
  "Ø±Ø¯": "response", "Ø±Ø£ÙŠ": "opinion", "ÙŠØ¬Ø¨": "must/should", "Ù†Ø±ÙƒØ²": "focus",
  "ÙŠÙˆØ¶Ø­": "clarify", "Ø¬Ø²Ø¡": "part", "Ø¯Ø¹Ù†Ø§": "let's", "Ù†Ø±Ø§Ø¬Ø¹": "review", "Ø£Ø³Ø¨ÙˆØ¹ÙŠ": "weekly",
  "Ø¹Ø¸ÙŠÙ…": "great", "Ù…Ø¬Ù‡ÙˆØ¯": "effort", "Ø§Ù„ÙŠÙˆÙ…": "today", "Ø§Ø³ØªÙ…Ø±": "keep it up", "ØªØ­Ø³Ù†": "improvement",
  "ÙˆØ§Ø¶Ø­": "visible", "Ù†Ø¹ØªÙ‚Ø¯": "believe", "Ù‡Ø¯Ù": "target", "ÙŠØªØ¨Ø¹": "follow", "Ù‚ÙˆØ§Ø¹Ø¯": "rules",
  "ÙƒÙ„": "every", "Ù…Ø­Ø¬ÙˆØ²": "booked", "Ù…ÙƒØªÙ…Ù„": "completed", "Ù…ØªÙƒØ±Ø±": "repeated",
  "Ø±ÙØ¶": "rejections", "Ø³ÙˆÙ": "will", "ÙŠØ¤Ø«Ø±": "affect", "ÙØ§ØªÙˆØ±Ø©": "invoice",
  "Ø·ÙˆÙŠÙ„": "long", "Ø§Ø³ØªØ±Ø§Ø­Ø§Øª": "breaks", "Ø®Ù„Ø§Ù„": "during", "Ø°Ø±ÙˆØ©": "peak", "Ø¹Ù…ÙŠÙ„": "customer",
  "ÙŠØ±Ø¯": "answer", "Ù‡Ø§ØªÙ": "phone", "ØºÙŠØ±": "changed/invalid", "ØªØ·Ø¨ÙŠÙ‚": "app", "ÙƒØ§Ù†": "was",
  "ÙŠØ³ØªØ¬ÙŠØ¨": "responding", "Ø¯Ù‚Ø§Ø¦Ù‚": "minutes", "Ø§Ø³ØªÙ„Ù…Ù†Ø§": "received", "Ø±Ø³Ø§Ù„Ø©": "message",
  "ÙØªØ­Ù†Ø§": "opened", "ÙÙˆØ±Ø§": "immediately", "Ø¹Ù„Ù…": "marked", "Ø®Ø·Ø£": "mistake/fault",
  "Ø¹Ø§Ù„Ù‚": "stuck", "Ø²Ø­Ø§Ù…": "traffic", "ÙŠØ²ÙŠÙ„": "remove", "Ù…Ø®Ø§Ù„ÙØ©": "penalty",
  "Ù†Ø³ØªÙ‡Ø¯Ù": "targeting", "Ø´Ù‡Ø±": "month", "Ù…Ù„Ù": "file", "Ø±Ø§Ø¨Ø·": "link", "Ø£Ø¯Ù†Ø§Ù‡": "below",
  "Ø­Ù„ÙˆÙ„": "solutions", "Ù„ÙˆÙ…": "blame", "ÙŠØ³ØªØ³Ù„Ù…": "give up", "Ù‚Ø±ÙŠØ¨": "close",
  "Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©": "consistency", "Ù…ÙØªØ§Ø­": "key", "Ù†Ø¬Ø§Ø­": "success", "Ø£Ø±Ø¨Ø¹Ø©": "four",
  "Ø­Ø§Ù„Ø©": "status/case", "ÙŠØªØ¬Ù†Ø¨": "avoid", "Ø¶Ø±ÙˆØ±ÙŠ": "necessary", "ÙŠØ­Ø¬Ø²": "book",
  "ÙˆØ§Ù‚Ø¹ÙŠ": "realistic", "Ø¥Ø¬Ù…Ø§Ù„ÙŠ": "total", "Ù…ØªØµÙ„": "online", "Ø³Ø§Ø¹Ø§Øª": "hours",
  "ÙŠØªØ¬Ø§ÙˆØ²": "exceed", "Ø¨Ø¯ÙˆÙ†": "without", "ÙŠØªØµÙ„": "call", "Ù‚Ø¨Ù„": "before",
  "ØªØ¹Ù„ÙŠÙ…": "marking", "Ù…ØªØ£Ø®Ø±": "delayed", "Ø£Ø¨Ù„ØºÙ†Ø§": "informed", "Ø®Ø¯Ù…Ø©": "service",
  "ÙŠØµØ¹Ø¯": "escalate", "Ø¯Ø¹Ù…": "support", "ÙØ±ÙŠÙ‚": "team", "Ø§Ø®ØªØ¨Ø§Ø±": "quiz",
  "ØµÙØ­Ø©": "page", "ØªØ­Ù…ÙŠÙ„": "loaded", "ØªÙ‚ÙŠÙŠÙ…": "assessment", "ÙŠÙ†Ø´Ø±": "published",
  "Ø§Ù„Ø£Ø­Ø¯": "Sunday", "ÙŠØ­Ù„Ù„": "analyze", "Ø¬Ø°Ø±ÙŠ": "root", "Ø³Ø¨Ø¨": "cause",
  "Ø¥Ø®ÙØ§Ù‚Ø§Øª": "failures", "ÙŠØ±ØªØ¯ÙŠ": "wear", "Ø±Ø³Ù…ÙŠ": "official", "Ø²ÙŠ": "uniform",
  "Ù‚Ø¯Ù…": "provided", "Ø®Ø§Ø·Ø¦": "wrong", "Ø¥ÙŠØ¬Ø§Ø¨ÙŠ": "positive", "Ù…ÙˆÙ‚Ù": "attitude",
  "Ù…Ù‚Ø¯Ø±": "appreciated", "Ù…Ø§Ø°Ø§": "what", "Ø®Ø·Ø©": "plan", "Ø¹Ù…Ù„": "action",
  "Ø±Ø¨Ø¹": "quarter", "Ù…ØªÙˆØ³Ø·": "average", "Ø®Ø§Ø¯Ù…": "server", "ØµÙŠØ§Ù†Ø©": "maintenance",
  "ÙŠØ·Ù„Ø¨": "requests", "ØªÙ„Ø§Ù…Ø³": "contactless", "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª": "information", "Ø´Ø®Øµ": "anyone",
  "ÙŠÙ†Ø´Ø¦": "create", "Ø¬Ø¯ÙŠØ¯": "new", "ØµØ­ÙŠØ­": "correct", "ÙØ±Ø¹": "branch",
  "Ù…Ø¬Ù…ÙˆØ¹Ø©": "group", "ÙŠØ±ÙØ¹": "upload", "Ø¥Ù„Ø²Ø§Ù…ÙŠ": "mandatory", "Ø§Ù„ØªØ²Ø§Ù…": "compliance",
  "Ù…Ø³ØªÙ†Ø¯Ø§Øª": "documents", "ÙŠØ®ØªØ§Ø±": "select", "Ù…Ø±ÙƒØ¨Ø©": "vehicle", "Ù†ÙˆØ¹": "type",
  "Ù†Ø§Ø±ÙŠØ©": "motorcycle", "Ø³ÙŠØ§Ø±Ø©": "car"
};

// ===== DATA (You can extend easily) =====
const DATA = [
  {cat:"Daily Communication", en:"Please confirm once you complete your delivery.", ar:"ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙˆØµÙŠÙ„."},
  {cat:"Daily Communication", en:"Kindly share your location.", ar:"Ù…Ù† ÙØ¶Ù„Ùƒ Ø´Ø§Ø±Ùƒ Ù…ÙˆÙ‚Ø¹Ùƒ."},
  {cat:"Daily Communication", en:"Start your shift on time.", ar:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø´ÙŠÙØª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯."},
  {cat:"Reporting & Issues", en:"The rider lost validity due to a system delay.", ar:"Ø§Ù„Ø³Ø§Ø¦Ù‚ ÙÙ‚Ø¯ ÙŠÙˆÙ… ØµØ§Ù„Ø­ Ø¨Ø³Ø¨Ø¨ ØªØ£Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…."},
  {cat:"Reporting & Issues", en:"The order was delayed due to a restaurant issue.", ar:"ØªÙ… ØªØ£Ø®ÙŠØ± Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø³Ø¨Ø¨ Ù…Ø´ÙƒÙ„Ø© Ù…Ù† Ø§Ù„Ù…Ø·Ø¹Ù…."},
  {cat:"Reporting & Issues", en:"The bike broke down during the delivery.", ar:"ØªØ¹Ø·Ù„Øª Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙˆØµÙŠÙ„."},
  {cat:"Performance", en:"The company performance dropped because of low on-time rate.", ar:"Ø§Ù†Ø®ÙØ¶ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ© Ø¨Ø³Ø¨Ø¨ Ø¶Ø¹Ù Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ÙˆÙ‚Øª."},
  {cat:"Performance", en:"We need to increase valid days to reach level A.", ar:"Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ØµØ§Ù„Ø­Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ A."},
  {cat:"Performance", en:"Please motivate your riders to improve their on-time rate.", ar:"ÙŠØ±Ø¬Ù‰ ØªØ­ÙÙŠØ² Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ù„ØªØ­Ø³ÙŠÙ† Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ÙˆÙ‚Øª."},
  {cat:"WhatsApp", en:"Please find the attached performance report.", ar:"ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø±ÙÙ‚."},
  {cat:"WhatsApp", en:"Kindly share the updated rider list.", ar:"Ù…Ù† ÙØ¶Ù„Ùƒ Ø´Ø§Ø±Ùƒ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ø§Ù„Ù…Ø­Ø¯Ø«Ø©."},
  {cat:"WhatsApp", en:"Thank you for your quick response.", ar:"Ø´ÙƒØ±Ù‹Ø§ Ø¹Ù„Ù‰ Ø±Ø¯Ùƒ Ø§Ù„Ø³Ø±ÙŠØ¹."},
  {cat:"Meetings", en:"In my opinion, we should focus on valid days.", ar:"Ø¨Ø±Ø£ÙŠÙŠØŒ ÙŠØ¬Ø¨ Ø£Ù† Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ØµØ§Ù„Ø­Ø©."},
  {cat:"Meetings", en:"Could you please clarify this part?", ar:"Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙˆØ¶ÙŠØ­ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ù…Ù† ÙØ¶Ù„ÙƒØŸ"},
  {cat:"Meetings", en:"Letâ€™s review the weekly report together.", ar:"Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ù…Ø¹Ù‹Ø§."},
  {cat:"Motivation", en:"Great effort today, keep it up!", ar:"Ù…Ø¬Ù‡ÙˆØ¯ Ø±Ø§Ø¦Ø¹ Ø§Ù„ÙŠÙˆÙ…ØŒ Ø§Ø³ØªÙ…Ø±!"},
  {cat:"Motivation", en:"Your improvement this week is visible.", ar:"ØªØ­Ø³Ù†Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙˆØ§Ø¶Ø­."},
  {cat:"Motivation", en:"We believe you can reach the target.", ar:"Ù†Ø«Ù‚ Ø£Ù†Ùƒ ØªØ³ØªØ·ÙŠØ¹ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù‡Ø¯Ù."},
  {cat:"Compliance", en:"Please follow the company rules.", ar:"ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø´Ø±ÙƒØ©."},
  {cat:"Compliance", en:"Every booked shift must be completed.", ar:"ÙƒÙ„ Ø´ÙŠÙØª Ù…Ø­Ø¬ÙˆØ² ÙŠØ¬Ø¨ Ø¥ÙƒÙ…Ø§Ù„Ù‡."},
  {cat:"Compliance", en:"Repeated rejections will affect your invoice.", ar:"ØªÙƒØ±Ø§Ø± Ø§Ù„Ø±ÙØ¶ Ø³ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ ÙØ§ØªÙˆØ±ØªÙƒ."},
  {cat:"Shifts", en:"Your shift starts at 10 AM.", ar:"Ø´ÙŠÙØªÙƒ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø³Ø§Ø¹Ø© 10 ØµØ¨Ø§Ø­Ù‹Ø§."},
  {cat:"Shifts", en:"Do not take long breaks during peak time.", ar:"Ù„Ø§ ØªØ£Ø®Ø° ÙØªØ±Ø§Øª Ø±Ø§Ø­Ø© Ø·ÙˆÙŠÙ„Ø© Ø®Ù„Ø§Ù„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ©."},
  {cat:"Shifts", en:"Please clock in and clock out properly.", ar:"ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­."},
  {cat:"Customer", en:"The customer did not answer the phone.", ar:"Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù… ÙŠØ±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ."},
  {cat:"Customer", en:"The customer changed the location.", ar:"Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠÙ‘Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹."},
  {cat:"Customer", en:"The customer delayed receiving the order.", ar:"ØªØ£Ø®Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨."},
  {cat:"System", en:"The app was not responding for a few minutes.", ar:"Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ù… ÙŠØ³ØªØ¬Ø¨ Ù„Ø¨Ø¶Ø¹ Ø¯Ù‚Ø§Ø¦Ù‚."},
  {cat:"System", en:"We received a Core message and opened it immediately.", ar:"Ø§Ø³ØªÙ„Ù…Ù†Ø§ Ø±Ø³Ø§Ù„Ø© Core ÙˆÙØªØ­Ù†Ø§Ù‡Ø§ ÙÙˆØ±Ù‹Ø§."},
  {cat:"System", en:"The system marked the day invalid by mistake.", ar:"Ø§Ù„Ù†Ø¸Ø§Ù… Ø³Ø¬Ù‘Ù„ Ø§Ù„ÙŠÙˆÙ… ÙƒØºÙŠØ± ØµØ§Ù„Ø­ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø®Ø·Ø£."},
];

// --- ADDED: Keeta-specific sentences ---
const EXTRA_IMPORT = [{"cat": "Keeta", "en": "Create a new courier with the correct branch and group.", "ar": "Ø£Ù†Ø´Ø¦ Ø³Ø§Ø¦Ù‚Ù‹Ø§ Ø¬Ø¯ÙŠØ¯Ù‹Ø§ Ù…Ø¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±Ø¹ ÙˆØ§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­."}, {"cat": "Keeta", "en": "Upload all mandatory compliance documents.", "ar": "Ù‚Ù… Ø¨Ø±ÙØ¹ Ø¬Ù…ÙŠØ¹ Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©."}, {"cat": "Keeta", "en": "Select the vehicle type: motorcycle or car.", "ar": "Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©: Ø¯Ø±Ø§Ø¬Ø© Ù†Ø§Ø±ÙŠØ© Ø£Ùˆ Ø³ÙŠØ§Ø±Ø©."}, {"cat": "Keeta", "en": "Use Live Monitoring for day-on-day and week-on-week comparisons.", "ar": "Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©."}, {"cat": "Keeta", "en": "Download data reports by selecting specific dates.", "ar": "Ø­Ù…Ù‘Ù„ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø§Ø®ØªÙŠØ§Ø± ØªÙˆØ§Ø±ÙŠØ® Ù…Ø­Ø¯Ø¯Ø©."}, {"cat": "Keeta", "en": "Use Real-time Courier Monitor to track riders by order or by courier.", "ar": "Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ø§Ù„Ù„Ø­Ø¸ÙŠØ© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨ Ø£Ùˆ Ø­Ø³Ø¨ Ø§Ù„Ø³Ø§Ø¦Ù‚."}, {"cat": "Keeta", "en": "Check status changes and task progress in real time.", "ar": "ØªØ­Ù‚Ù‚ Ù…Ù† ØªØºÙŠÙ‘Ø± Ø§Ù„Ø­Ø§Ù„Ø§Øª ÙˆØªÙ‚Ø¯Ù‘Ù… Ø§Ù„Ù…Ù‡Ø§Ù… ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ."}, {"cat": "Keeta", "en": "Open the Order Center to view complete order details.", "ar": "Ø§ÙØªØ­ Ù…Ø±ÙƒØ² Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ ÙƒØ§Ù…Ù„Ø©."}, {"cat": "Keeta", "en": "Click 'view' to see the full delivery flow.", "ar": "Ø§Ø¶ØºØ· \"Ø¹Ø±Ø¶\" Ù„Ø±Ø¤ÙŠØ© Ù…Ø³Ø§Ø± Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„."}, {"cat": "Keeta", "en": "Use the Violation Center to track penalties and appeals.", "ar": "Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¬Ø²Ø§Ø¡Ø§Øª ÙˆØ§Ù„ØªØ¸Ù„Ù…Ø§Øª."}, {"cat": "Keeta", "en": "Open the penalty details to review evidence and status.", "ar": "Ø§ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø¯Ù„Ø© ÙˆØ§Ù„Ø­Ø§Ù„Ø©."}, {"cat": "Keeta", "en": "Check Penalty Management for all active deductions.", "ar": "Ø§ÙØ­Øµ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø²Ø§Ø¡Ø§Øª Ù„ÙƒÙ„ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª Ø§Ù„ÙØ¹Ù‘Ø§Ù„Ø©."}, {"cat": "Keeta", "en": "Go to Financial Management to review billing details.", "ar": "Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±."}, {"cat": "Keeta", "en": "Download the bill breakdown by rider and by order.", "ar": "Ù‚Ù… Ø¨ØªÙ†Ø²ÙŠÙ„ ØªÙØµÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø³Ø§Ø¦Ù‚ ÙˆØ­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨."}, {"cat": "Keeta", "en": "Use the standard template to create a tax invoice.", "ar": "Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø¶Ø±ÙŠØ¨ÙŠØ©."}, {"cat": "Keeta", "en": "Confirm the bill before uploading the invoice.", "ar": "Ù‚Ù… Ø¨ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù‚Ø¨Ù„ Ø±ÙØ¹ Ø§Ù„Ø¥ÙŠØµØ§Ù„."}, {"cat": "Keeta", "en": "Open Payment Details to view payment dates and balances.", "ar": "Ø§ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø£Ø±ØµØ¯Ø©."}, {"cat": "Keeta", "en": "Add supervisors under Staff Management â†’ Operation Staff.", "ar": "Ø£Ø¶Ù Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ† Ù…Ù† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† â† Ø·Ø§Ù‚Ù… Ø§Ù„ØªØ´ØºÙŠÙ„."}, {"cat": "Keeta", "en": "Create a Supervisor Group and assign positions.", "ar": "Ø£Ù†Ø´Ø¦ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø´Ø±ÙÙŠÙ† ÙˆØ­Ø¯Ø¯ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù."}, {"cat": "Keeta", "en": "Check assessment plans and progress in Incentive Management.", "ar": "Ø±Ø§Ø¬Ø¹ Ø®Ø·Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙˆØ§Ù„ØªÙ‚Ø¯Ù… ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­ÙˆØ§ÙØ²."}, {"cat": "Keeta", "en": "Targets and weights will be announced monthly.", "ar": "Ø³ÙŠØªÙ… Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙˆØ§Ù„Ø£ÙˆØ²Ø§Ù† Ø´Ù‡Ø±ÙŠÙ‹Ø§."}, {"cat": "Keeta", "en": "Check the Message Center for internal notifications.", "ar": "Ø§ÙØ­Øµ Ù…Ø±ÙƒØ² Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©."}, {"cat": "Keeta", "en": "Log in 15 minutes before your shift starts.", "ar": "Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‚Ø¨Ù„ Ø¨Ø¯Ø§ÙŠØ© Ø´ÙŠÙØªÙƒ Ø¨Ù€ 15 Ø¯Ù‚ÙŠÙ‚Ø©."}, {"cat": "Keeta", "en": "Log out 15 minutes after your shift ends.", "ar": "Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ø¹Ø¯ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø´ÙŠÙØª Ø¨Ù€ 15 Ø¯Ù‚ÙŠÙ‚Ø©."}, {"cat": "Keeta", "en": "Use your registered phone or email to log in to the partner platform.", "ar": "Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø§ØªÙÙƒ Ø§Ù„Ù…Ø³Ø¬Ù„ Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ù†ØµØ© Ø§Ù„Ø´Ø±ÙƒØ§Ø¡."}, {"cat": "Keeta", "en": "Book shifts weekly on Wednesday at 4:00 PM.", "ar": "Ø§Ø­Ø¬Ø² Ø§Ù„Ø´ÙŠÙØªØ§Øª Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ‹Ø§ ÙŠÙˆÙ… Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡ Ø§Ù„Ø³Ø§Ø¹Ø© 4:00 Ù…Ø³Ø§Ø¡Ù‹."}, {"cat": "Keeta", "en": "Cancel shifts 72 hours before the start time.", "ar": "Ø£Ù„ØºÙ Ø§Ù„Ø´ÙŠÙØª Ù‚Ø¨Ù„ Ø¨Ø¯Ø§ÙŠØªÙ‡ Ø¨Ù€ 72 Ø³Ø§Ø¹Ø©."}, {"cat": "Keeta", "en": "Choose your primary zone first; secondary zones if full.", "ar": "Ø§Ø®ØªØ± Ù…Ù†Ø·Ù‚ØªÙƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø£ÙˆÙ„Ù‹Ø§Ø› ÙˆØ§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø¥Ø°Ø§ Ø§Ù…ØªÙ„Ø£Øª."}, {"cat": "Keeta", "en": "Stay within your zone during shifts; return quickly if you go out.", "ar": "Ø§Ø¨Ù‚ Ø¯Ø§Ø®Ù„ Ù…Ù†Ø·Ù‚ØªÙƒ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø´ÙŠÙØªØ› ÙˆØ§Ø±Ø¬Ø¹ Ø¨Ø³Ø±Ø¹Ø© Ø¥Ø°Ø§ Ø®Ø±Ø¬Øª."}, {"cat": "Keeta", "en": "You will be logged off after 25 minutes outside the zone.", "ar": "Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ 25 Ø¯Ù‚ÙŠÙ‚Ø© Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©."}, {"cat":"Keeta", "en": "Use up to 10% of your shift as break time.", "ar": "ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø­ØªÙ‰ 10Ùª Ù…Ù† Ø§Ù„Ø´ÙŠÙØª ÙƒÙˆÙ‚Øª Ø§Ø³ØªØ±Ø§Ø­Ø©."}, {"cat": "Keeta", "en": "Keep online at least 90% of the booked time.", "ar": "Ø§Ø¨Ù‚Ù Ù…ØªØµÙ„Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 90Ùª Ù…Ù† ÙˆÙ‚Øª Ø§Ù„Ø´ÙŠÙØª Ø§Ù„Ù…Ø­Ø¬ÙˆØ²."}, {"cat": "Keeta", "en": "Green tick means good attendance performance.", "ar": "Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ ØªØ¹Ù†ÙŠ Ø£Ø¯Ø§Ø¡ Ø­Ø¶ÙˆØ± Ø¬ÙŠØ¯."}, {"cat": "Keeta", "en": "Tap 'Arrived at Restaurant' when you reach the store.", "ar": "Ø§Ø¶ØºØ· \"ÙˆØµÙ„Øª Ù„Ù„Ù…Ø·Ø¹Ù…\" Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„Ùƒ Ù„Ù„Ù…Ø·Ø¹Ù…."}, {"cat": "Keeta", "en": "Tap 'Pick Up' after receiving the order.", "ar": "Ø§Ø¶ØºØ· \"Ø§Ø³ØªÙ„Ø§Ù…\" Ø¨Ø¹Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨."}, {"cat": "Keeta", "en": "Tap 'Confirm Drop Off' and upload a proof photo.", "ar": "Ø§Ø¶ØºØ· \"ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…\" ÙˆØ§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø¥Ø«Ø¨Ø§Øª."}, {"cat": "Keeta", "en": "Use in-app chat to contact the customer; messages stay for 48 hours.", "ar": "Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„Ø› Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªØ¨Ù‚Ù‰ 48 Ø³Ø§Ø¹Ø©."}, {"cat": "Keeta", "en": "Share your pin location to coordinate easily.", "ar": "Ø´Ø§Ø±Ùƒ Ù…ÙˆÙ‚Ø¹Ùƒ Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚."}, {"cat": "Keeta", "en": "Report abnormal situations via the Abnormal Report feature.", "ar": "Ø£Ø¨Ù„Øº Ø¹Ù† Ø§Ù„Ø­Ø§Ù„Ø§Øª ØºÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¹Ø¨Ø± Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØºÙŠØ± Ø§Ù„Ø¹Ø§Ø¯ÙŠ."}, {"cat": "Keeta", "en": "Appeals must be submitted within 48 hours of the penalty notice.", "ar": "ÙŠØ¬Ø¨ ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ØªØ¸Ù„Ù‘Ù… Ø®Ù„Ø§Ù„ 48 Ø³Ø§Ø¹Ø© Ù…Ù† Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©."}];
EXTRA_IMPORT.forEach(x=>DATA.push(x));
// --- End of added data ---


// Add many more items quickly:
const EXTRA = [
  ["Reporting & Issues","The rider was stuck due to traffic.","ØªØ¹Ø·Ù„ Ø§Ù„Ø³Ø§Ø¦Ù‚ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø²Ø­Ø§Ù…."],
  ["Reporting & Issues","Please remove this penalty; it was not the rider's fault.","ÙŠØ±Ø¬Ù‰ Ø¥Ø²Ø§Ù„Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©Ø› Ù„Ù… ØªÙƒÙ† Ø®Ø·Ø£ Ø§Ù„Ø³Ø§Ø¦Ù‚."],
  ["Performance","We are targeting level A this month.","Ù†Ø³ØªÙ‡Ø¯Ù Ø§Ù„Ù…Ø³ØªÙˆÙ‰ A Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±."],
  ["Performance","Our on-time rate needs improvement.","Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ÙˆÙ‚Øª Ù„Ø¯ÙŠÙ†Ø§ ØªØ­ØªØ§Ø¬ Ù„ØªØ­Ø³ÙŠÙ†."],
  ["WhatsApp","I have shared the file link below.","Ù‚Ù…Øª Ø¨Ù…Ø´Ø§Ø±ÙƒØ© Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù Ø£Ø¯Ù†Ø§Ù‡."],
  ["WhatsApp","Please update the attendance record.","ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±."],
  ["Meetings","Let's focus on solutions, not blame.","Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù„ÙˆÙ„ Ù„Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ…."],
  ["Meetings","We will align with Keeta's rules.","Ø³Ù†Ù„ØªØ²Ù… Ø¨Ù‚ÙˆØ§Ø¹Ø¯ ÙƒÙŠØªØ§."],
  ["Motivation","Don't give up, you are close to the target.","Ù„Ø§ ØªØ³ØªØ³Ù„Ù…ØŒ Ø£Ù†Øª Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ù‡Ø¯Ù."],
  ["Motivation","Your consistency is the key to success.","Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ù‡ÙŠ Ù…ÙØªØ§Ø­ Ø§Ù„Ù†Ø¬Ø§Ø­."],
  ["Compliance","Four invalid days will affect your status.","Ø£Ø±Ø¨Ø¹Ø© Ø£ÙŠØ§Ù… ØºÙŠØ± ØµØ§Ù„Ø­Ø© Ø³ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ ÙˆØ¶Ø¹Ùƒ."],
  ["Compliance","Please avoid unnecessary rejections.","ÙŠØ±Ø¬Ù‰ ØªØ¬Ù†Ø¨ Ø§Ù„Ø±ÙØ¶ ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ."],
  ["Shifts","Book realistic shifts and complete them.","Ø§Ø­Ø¬Ø² Ø´ÙŠÙØªØ§Øª ÙˆØ§Ù‚Ø¹ÙŠØ© ÙˆØ£ÙƒÙ…Ù„Ù‡Ø§."],
  ["Shifts","Total online hours must exceed 10 without breaks.","ÙŠØ¬Ø¨ Ø£Ù† ØªØªØ¬Ø§ÙˆØ² Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØµÙ„Ø© 10 Ø¨Ø¯ÙˆÙ† ÙÙˆØ§ØµÙ„."],
  ["Customer","Please call the customer before marking delayed.","ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‚Ø¨Ù„ ÙˆØ¶Ø¹ ØªØ£Ø®ÙŠØ±."],
  ["Customer","We informed the customer service about this case.","Ù‚Ù…Ù†Ø§ Ø¨Ø¥Ø¨Ù„Ø§Øº Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø©."],
  ["System","We will escalate this issue to the support team.","Ø³Ù†ØµØ¹Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¥Ù„Ù‰ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù…."],
  ["System","The quiz page loaded late due to system delay.","ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØªØ£Ø®Ø±Øª ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù…."],
  // --- NEWLY ADDED SENTENCES ---
  ["Performance", "The weekly assessment will be published on Sunday.", "Ø³ÙŠØªÙ… Ù†Ø´Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ ÙŠÙˆÙ… Ø§Ù„Ø£Ø­Ø¯."],
  ["Performance", "We need to analyze the root cause of the failures.", "Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ø¬Ø°Ø±ÙŠ Ù„Ù„Ø¥Ø®ÙØ§Ù‚Ø§Øª."],
  ["Compliance", "All riders must wear the official uniform.", "ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø§Ø¦Ù‚ÙŠÙ† Ø§Ø±ØªØ¯Ø§Ø¡ Ø§Ù„Ø²ÙŠ Ø§Ù„Ø±Ø³Ù…ÙŠ."],
  ["Reporting & Issues", "The customer provided the wrong PIN location.", "Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ø¯Ø®Ù„ Ù…ÙˆÙ‚Ø¹ PIN Ø®Ø§Ø·Ø¦."],
  ["Motivation", "Your positive attitude is appreciated.", "Ù†Ù‚Ø¯Ø± Ù…ÙˆÙ‚ÙÙƒ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ."],
  ["Meetings", "What is the action plan for this quarter?", "Ù…Ø§ Ù‡ÙŠ Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ø¨Ø¹ØŸ"],
  ["Performance", "Average delivery time has improved by 10%.", "ØªØ­Ø³Ù† Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¨Ù†Ø³Ø¨Ø© 10Ùª."],
  ["System", "The server is down for maintenance.", "Ø§Ù„Ø®Ø§Ø¯Ù… Ù…ØªÙˆÙ‚Ù Ù„Ù„ØµÙŠØ§Ù†Ø©."],
  ["Customer", "The customer requests a contactless delivery.", "Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙŠØ·Ù„Ø¨ ØªÙˆØµÙŠÙ„ Ø¨Ø¯ÙˆÙ† ØªÙ„Ø§Ù…Ø³."],
  ["Compliance", "Do not share customer information with anyone.", "Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ."]
];
EXTRA.forEach(([cat,en,ar])=>DATA.push({cat,en,ar}));

// --- NEW: Create 10,000+ exercise pool ---
const uniqueSentences = DATA.slice(); // Copy all unique sentences (around 150+)
const numUnique = uniqueSentences.length;
while(DATA.length < 10000) { // Target 10,000
  DATA.push(uniqueSentences[DATA.length % numUnique]); 
}
// ---

const CATS = ["All", ...[...new Set(uniqueSentences.map(x=>x.cat))]]; // Categories from unique sentences

// ===== STATE =====
const LS = (k,v)=> v===undefined ? JSON.parse(localStorage.getItem(k)||"null") : localStorage.setItem(k,JSON.stringify(v));
const state = {
  idx:0, order:[], mode:"daily", xp: LS("xp") ?? 0,
  streak: LS("streak") ?? 0, lastDay: LS("lastDay") ?? null, wrong: LS("wrong") ?? [],
  goal:20, ui:"ar", exMode: "both", cat: "All",
  currentQuestionText: "", // For re-speaking
  currentLang: "" // For re-speaking
};

// ===== INIT UI =====
const el = id=>document.getElementById(id);
const xpEl = el("xp"), streakEl = el("streak"), barEl = el("bar"), goalText = el("goalText");
const btnStart = el("btnStart"), btnCheck = el("btnCheck"), btnSkip = el("btnSkip"), btnHint = el("btnHint"), btnSpeak = el("btnSpeak");
const qEl = el("question"), mcEl = el("mc"), typingEl = el("typing"), ansEl = el("answer"), resEl = el("result"), hintEl = el("hint");
const btnDaily = el("btnDaily"), btnReview = el("btnReview"), screenLesson = el("screenLesson"), screenReview = el("screenReview");
const uiLang = el("uiLang"), exerciseLang = el("exerciseLang"), catTag = el("catTag"), catsDiv = el("cats");

// --- NEW: Mobile Nav Elements ---
const mobileNav = el("mobileNav");
const mainPanel = el("mainPanel");
const settingsPanel = el("settingsPanel");
const mobileNavButtons = mobileNav.querySelectorAll("button");
// ===================================

// ===== Speech Synthesis =====
const synth = window.speechSynthesis;
let voices = [];
function populateVoices(){
  voices = synth.getVoices();
}
populateVoices();
if (synth.onvoiceschanged !== undefined) {
  synth.onvoiceschanged = populateVoices;
}
function speak(text, langCode){
  if (synth.speaking) {
    synth.cancel(); // Stop any previous speech
  }
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = langCode;
  
  let voice = voices.find(v => v.lang === langCode);
  if(langCode === 'en-US' && !voice) {
    voice = voices.find(v => v.lang.startsWith('en-')); // Fallback for English
  }
  if(langCode === 'ar-SA' && !voice) {
    voice = voices.find(v => v.lang.startsWith('ar-')); // Fallback for Arabic
  }
  
  utter.voice = voice;
  synth.speak(utter);
}
btnSpeak.onclick = () => {
  if (state.currentQuestionText) {
    speak(state.currentQuestionText, state.currentLang);
  }
};
// ===================================


function updateHeader(){
  xpEl.textContent = state.xp;
  streakEl.textContent = state.streak;
  const progress = Math.min(100, Math.round((state.xp%state.goal)/state.goal*100));
  barEl.style.width = progress+"%";
  goalText.textContent = `${state.xp%state.goal}/${state.goal} XP`;
  LS("xp",state.xp); LS("streak",state.streak);
}

function ensureStreak(){
  const today = new Date().toISOString().slice(0,10);
  if(state.lastDay!==today){
    const prev = state.lastDay;
    if(prev){
      const d1 = new Date(prev), d2 = new Date(today);
      const diff = (d2 - d1)/86400000;
      if(diff===1) state.streak += 1;
      else state.streak = 1;
    }else{
      state.streak = 1;
    }
    state.lastDay = today;
    LS("lastDay",state.lastDay); LS("streak",state.streak);
  }
}

function saveWrong(pair, dir){
  state.wrong.push({pair, dir, time: Date.now()});
  if(state.wrong.length>50) state.wrong.shift();
  LS("wrong",state.wrong);
}

function renderWrongList(){
  const box = el("revList");
  if(state.wrong.length===0){ box.innerHTML = "<div class='muted'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</div>"; return; }
  box.innerHTML = state.wrong.slice(-20).reverse().map(w=>{
    const q = w.dir==="en2ar"? w.pair.en : w.pair.ar;
    const a = w.dir==="en2ar"? w.pair.ar : w.pair.en;
    return `<div class='card' style="margin:8px 0"><div class='muted'>Ø³Ø¤Ø§Ù„</div><div>${q}</div><div class='muted'>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</div><div>${a}</div></div>`
  }).join("");
}

// --- MODIFIED: setMode now just handles the screens *inside* mainPanel ---
function setMode(m){
  state.mode = m;
  if(m==="daily"){
    screenLesson.classList.remove("hidden");
    screenReview.classList.add("hidden");
  } else {
    screenLesson.classList.add("hidden");
    screenReview.classList.remove("hidden");
    renderWrongList();
  }
  // Desktop buttons
  btnDaily.classList.toggle("primary", m==="daily");
  btnReview.classList.toggle("primary", m==="review");
}
btnDaily.onclick=()=>setMode("daily");
btnReview.onclick=()=>setMode("review");

// --- NEW: Mobile Tab Navigation ---
function setMobileTab(tab) {
  mobileNavButtons.forEach(btn => {
    btn.classList.toggle("active", btn.dataset.tab === tab);
  });
  
  if (tab === 'lesson') {
    mainPanel.style.display = 'block';
    settingsPanel.style.display = 'none';
    setMode('daily'); // Show lesson screen inside main panel
  } else if (tab === 'review') {
    mainPanel.style.display = 'block';
    settingsPanel.style.display = 'none';
    setMode('review'); // Show review screen inside main panel
  } else if (tab === 'settings') {
    mainPanel.style.display = 'none';
    settingsPanel.style.display = 'block';
  }
}
mobileNavButtons.forEach(btn => {
  btn.onclick = () => setMobileTab(btn.dataset.tab);
});
// ===================================


uiLang.onchange = ()=>{
  state.ui = uiLang.value;
  document.documentElement.lang = state.ui==="ar"?"ar":"en";
  document.documentElement.dir = state.ui==="ar"?"rtl":"ltr";
}
exerciseLang.onchange = ()=>{ state.exMode = exerciseLang.value; startLesson(); }

// Categories
function renderCats(){
  const btn = (name)=>`<button class="${state.cat===name?'primary':''}" data-cat="${name}">${name==='All'?'ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª':name}</button>`;
  catsDiv.innerHTML = btn("All")+CATS.map(c=>btn(c)).join("");
  catsDiv.querySelectorAll("button").forEach(b=>b.onclick = ()=>{ state.cat=b.dataset.cat; startLesson(); renderCats(); });
}
renderCats();

function shuffle(a){ return a.map(x=>[Math.random(), x]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]); }

// --- NEW: Efficient pickPool function (doesn't shuffle 10,000 items) ---
function pickPool(){
  let sourcePool = DATA;
  // Use the *unique* sentences if filtering by category
  if(state.cat!=="All") {
     sourcePool = uniqueSentences.filter(x=>x.cat===state.cat);
  } else {
     sourcePool = DATA; // Use the full 10k pool if "All"
  }
  
  // Don't shuffle the whole 10,000 array.
  // Just pick random items from the source pool.
  let lessonPool = [];
  const lessonSize = state.goal * 2; // e.g., 40 exercises
  for(let i=0; i < lessonSize; i++) {
    lessonPool.push(sourcePool[Math.floor(Math.random() * sourcePool.length)]);
  }
  return lessonPool; // This is already shuffled by nature of picking randomly.
}

function startLesson(){
  state.order = pickPool();
  state.idx = 0;
  updateHeader();
  nextQuestion();
  
  // --- NEW: On mobile, ensure the "lesson" tab is active when starting
  if (window.innerWidth < 900) {
    setMobileTab('lesson');
  }
}
btnStart.onclick = startLesson;

function nextQuestion(){
  resEl.textContent=""; hintEl.textContent="";
  mcEl.classList.add("hidden"); typingEl.classList.add("hidden");
  if(state.idx >= state.order.length){ 
    qEl.textContent = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¯Ø±Ø³! Ø±Ø§Ø¦Ø¹ ğŸ‘"; 
    state.currentQuestionText = "";
    state.currentLang = "";
    return; 
  }

  const pair = state.order[state.idx];
  const dir = decideDir();
  catTag.textContent = pair.cat;
  
  let isTyping = Math.random() < 0.8; // 80% focus on writing
  if(dir==="ar2en") isTyping = true; // Always writing for Ar -> En
  
  const question = dir==="en2ar"? pair.en : pair.ar;
  
  // --- NEW: Word-for-Word Hover feature ---
  const currentDict = (dir === "en2ar") ? MINI_DICT_EN_AR : MINI_DICT_AR_EN;
  qEl.innerHTML = question.split(' ').map(w_raw => {
    // Clean the word of punctuation for lookup
    const w_clean = w_raw.toLowerCase().replace(/[.,!?'"â€œâ€]/g, '');
    const translation = currentDict[w_clean] || "ØŸØŸØŸ"; // Find translation or show '???'
    return `<span class="hover-word" title="${translation}">${w_raw}</span>`;
  }).join(' ');

  // --- Store text for speak-on-click ---
  state.currentQuestionText = question;
  state.currentLang = (dir === "en2ar") ? 'en-US' : 'ar-SA';
  
  // --- REMOVED: Automatic speech ---
  // speak(state.currentQuestionText, state.currentLang);
  // ---

  hintEl.textContent = dir==="en2ar"? "ØªØ±Ø¬Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" : "ØªØ±Ø¬Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©";

  if(isTyping){
    typingEl.classList.remove("hidden");
    ansEl.value=""; ansEl.focus();
    btnCheck.onclick = ()=>{
      const user = ansEl.value.trim();
      const correct = dir==="en2ar"? pair.ar : pair.en;
      
      if(equalLoose(user, correct)){
        resEl.innerHTML = "âœ… ØµØ­ÙŠØ­";
        state.xp += 5; updateHeader();
        state.idx++; setTimeout(nextQuestion, 700);
      }else{
        resEl.innerHTML = "âŒ Ø®Ø·Ø£<br><span class='muted'>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: </span>"+correct;
        saveWrong(pair, dir);
      }
    };
    btnHint.onclick = ()=>{ hintEl.textContent = "ØªÙ„Ù…ÙŠØ­: "+(dir==="en2ar"? pair.ar : pair.en).slice(0, Math.ceil((dir==="en2ar"? pair.ar : pair.en).length/3))+"..." }
  }else{
    // Multiple Choice Fallback
    mcEl.classList.remove("hidden");
    const correct = dir==="en2ar"? pair.ar : pair.en;
    const opts = [correct];
    
    // --- NEW: Efficient logic for distractors (doesn't shuffle 10,000 items) ---
    while(opts.length < 4) {
      const randomPair = DATA[Math.floor(Math.random() * DATA.length)];
      const o = dir==="en2ar"? randomPair.ar : randomPair.en;
      if (o !== correct && !opts.includes(o)) {
        opts.push(o);
      }
    }
    shuffle(opts); // Shuffle the final 4 options. This is fast.
    
    mcEl.innerHTML = opts.map(o=>`<div class="choice">${o}</div>`).join("");
    
    mcEl.querySelectorAll(".choice").forEach(ch=>{
      ch.onclick = ()=>{
        if(ch.textContent===correct){
          ch.classList.add("correct"); resEl.textContent="âœ… ØµØ­ÙŠØ­"; state.xp+=5; updateHeader();
          setTimeout(()=>{ state.idx++; nextQuestion(); }, 500);
        }else{
          ch.classList.add("wrong"); resEl.innerHTML = "âŒ Ø®Ø·Ø£";
          saveWrong(pair, dir);
        }
      };
    });
    btnCheck.onclick = ()=>{}; // not used
    btnHint.onclick = ()=>{ hintEl.textContent = "Ø§Ù„ØªÙˆØ§ÙÙ‚: "+(dir==="en2ar"? pair.en : pair.ar); }
  }
  btnSkip.onclick = ()=>{ state.idx++; nextQuestion(); };
}

function decideDir(){
  if(state.exMode==="en2ar") return "en2ar";
  if(state.exMode==="ar2en") return "ar2en";
  return Math.random()<0.5? "en2ar":"ar2en";
}
function equalLoose(a,b){
  const clean = s=>s.toLowerCase().replace(/[^\p{Letter}\p{Number}\s]/gu,"").replace(/\s+/g," ").trim();
  return clean(a)===clean(b);
}

// Review practice
el("btnPracticeWrong").onclick = ()=>{
  if(state.wrong.length===0){ alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©."); return; }
  state.order = shuffle(state.wrong.map(w=>w.pair));
  state.idx = 0;
  setMode("daily");
  nextQuestion();
  
  // --- NEW: On mobile, ensure the "lesson" tab is active
  if (window.innerWidth < 900) {
    setMobileTab('lesson');
  }
};

// Initial
ensureStreak();
updateHeader();

// --- NEW: Set initial mobile tab ---
if (window.innerWidth < 900) {
    setMobileTab('lesson');
}

</script>
</body>
</html>
